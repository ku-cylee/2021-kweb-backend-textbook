\section{JS Exercise Answers} \label{sect:js-exercise-answers}

\subsection*{Exercise 1}

\begin{codeenv}{code:dom-1-answer}{Exercise 1 Answer}\begin{verbatim}
const setRandomBgColor = () => {
    const red = Math.floor(Math.random() * 256);
    const blue = Math.floor(Math.random() * 256);
    const green = Math.floor(Math.random() * 256);
    const newColor = 'rgb(' + red + ',' + blue + ',' + green + ')';
    document.getElementById('color-box').style.backgroundColor = newColor;
};
\end{verbatim}
\end{codeenv}

\subsection*{Exercise 2}

\begin{codeenv}{code:dom-2-answer}{Exercise 2 Answer}\begin{verbatim}
const displayTimesResult = () => {
    const number = document.getElementById('number').value;
    const parsedNumber = parseInt(number);
    const timesResult = document.getElementById('times-result');

    if (!isFinite(parsedNumber) || isNaN(parsedNumber)) {
        return timesResult.innerText = 'Input Error!';
    }
    
    if (parsedNumber != number) {
        return timesResult.innerText = 'Input Error!';
    }

    if (parsedNumber < 1 || parsedNumber > 9) {
        return timesResult.innerText = 'Input Error!';
    }

    const result = [];
    for (let i = 1; i <= 9; i++) {
        result.push(parsedNumber + ' X ' + i + ' = ' + parsedNumber * i);
    }
    timesResult.innerText = result.join('\n');
};
\end{verbatim}
\end{codeenv}

\subsection*{Exercise 3}

\begin{codeenv}{code:dom-3-answer}{Exercise 3 Answer}\begin{verbatim}
const changeBoxColor = () => {
    const box = document.getElementsByClassName('box')[1];
    box.style.backgroundColor = 'blue';
};
\end{verbatim}
\end{codeenv}
\newpage

\subsection*{Exercise 4}

\begin{codeenv}{code:bom-1-answer}{Exercise 4 Answer}\begin{verbatim}
const probs = [ 100, 60, 36, 22, 13, 8, 5, 3, 2, 1 ];

let attempts = 0;
let level = 0;

const getRandomBinaryResult = ratio => {
    const randomNumber = Math.floor(Math.random() * 100);
    return (randomNumber < ratio);
};

const tryLevelUp = () => {
    const loopId = setInterval(() => {
        attempts++;
        const successed = getRandomBinaryResult(probs[level]);
        if (successed) {
            level++;
            document.getElementById('gauge-bar').style.width = level * 10 + '%';
            document.getElementById('current-level').innerText = level;
        }
        document.getElementById('attempts').innerText = attempts;
        if (level >= 10) clearInterval(loopId);
    }, 50);
};
\end{verbatim}
\end{codeenv}

\subsection*{Exercise 5}

\begin{codeenv}{code:event-1-answer}{Exercise 5 Answer}\begin{verbatim}
const itemPrice = {
    apple: 700, 
    orange: 800, 
    lemon: 900, 
};
let totalPrice = 0;

for (const buttonEl of document.getElementsByClassName('add-to-cart')) {
    buttonEl.addEventListener('click', event => {
        const itemName = event.target.parentNode.parentNode.getAttribute('id');
        totalPrice += itemPrice[itemName];
        document.getElementById('cost').innerText = totalPrice;
    });
}
\end{verbatim}
\end{codeenv}
\newpage

\subsection*{Exercise 6}

\begin{codeenv}{code:event-2-answer}{Exercise 6}\begin{verbatim}
const gamePanelEl = document.getElementById('game-panel');
const circlePos = { x: 740, y: 40 };
const squarePos = { x: 40, y: 440 };
const KEY_CODE = { UP: 38, DOWN: 40, LEFT: 37, RIGHT: 39 };

const setGameObjectPosition = (gameObject, position) => {
    gameObject.style.left = position.x + 'px';
    gameObject.style.top = position.y + 'px';
};

const moveGameObjectByKey = (pos, keyCode) => {
    const newPos = { x: pos.x, y: pos.y };
    switch (keyCode) {
        case KEY_CODE.UP:
            newPos.y -= 100; break;
        case KEY_CODE.DOWN:
            newPos.y += 100; break;
        case KEY_CODE.LEFT:
            newPos.x -= 100; break;
        case KEY_CODE.RIGHT:
            newPos.x += 100; break;
    }
    return newPos;
}

const isGameObjectOutOfRange = (pos) => {
    return (pos.x < 0) || (pos.x > 800) || (pos.y < 0) || (pos.y > 500);
};

document.addEventListener('keydown', (event) => {
    const newPos = moveGameObjectByKey(squarePos, event.keyCode);

    if (isGameObjectOutOfRange(newPos)) {
        return alert('Square gets out of range!');
    } else {
        squarePos.x = newPos.x;
        squarePos.y = newPos.y;
        setGameObjectPosition(squareEl, newPos);
    }

    if (squarePos.x === circlePos.x && squarePos.y === circlePos.y) {
        gamePanelEl.removeChild(circleEl);
        document.getElementById('success-message').innerText = 'You won the game!';
    }
});
\end{verbatim}
\end{codeenv}
